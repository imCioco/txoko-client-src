; Listing generated by Microsoft (R) Optimizing Compiler Version 19.44.35217.0 

	TITLE	d:\_m2work\txoko-m2-work\txoko-client-src\vs_files\userinterface\distribute\pythonnetworkstreamphasehandshake.obj
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	??_C@_09JMFCPCNF@HandShake@			; `string'
PUBLIC	??_C@_0M@EEFIMJHD@OnHandShake@			; `string'
PUBLIC	??_C@_0CB@IOMBLCGI@?$CD?$CD?5Network?5?9?5Hand?5Shake?5Phase?5?$CD@ ; `string'
PUBLIC	??_C@_0BF@EDCCLJMF@HShield?3?5Recv?5failed@	; `string'
PUBLIC	??_C@_0BI@JCCALMCB@HANDSHAKE?5OK?5RECV?5?$CFu?5?$CFu@ ; `string'
PUBLIC	??_C@_0BD@NKNICBOJ@XTrap?3?5Send?5failed@	; `string'
PUBLIC	??_C@_0BD@DGLFIMMB@XTrap?3?5Recv?5failed@	; `string'
EXTRN	?SetBaseTime@CTimer@@QAEXXZ:PROC		; CTimer::SetBaseTime
;	COMDAT ??_C@_0BD@DGLFIMMB@XTrap?3?5Recv?5failed@
CONST	SEGMENT
??_C@_0BD@DGLFIMMB@XTrap?3?5Recv?5failed@ DB 'XTrap: Recv failed', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BD@NKNICBOJ@XTrap?3?5Send?5failed@
CONST	SEGMENT
??_C@_0BD@NKNICBOJ@XTrap?3?5Send?5failed@ DB 'XTrap: Send failed', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BI@JCCALMCB@HANDSHAKE?5OK?5RECV?5?$CFu?5?$CFu@
CONST	SEGMENT
??_C@_0BI@JCCALMCB@HANDSHAKE?5OK?5RECV?5?$CFu?5?$CFu@ DB 'HANDSHAKE OK RE'
	DB	'CV %u %u', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0BF@EDCCLJMF@HShield?3?5Recv?5failed@
CONST	SEGMENT
??_C@_0BF@EDCCLJMF@HShield?3?5Recv?5failed@ DB 'HShield: Recv failed', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CB@IOMBLCGI@?$CD?$CD?5Network?5?9?5Hand?5Shake?5Phase?5?$CD@
CONST	SEGMENT
??_C@_0CB@IOMBLCGI@?$CD?$CD?5Network?5?9?5Hand?5Shake?5Phase?5?$CD@ DB '#'
	DB	'# Network - Hand Shake Phase ##', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0M@EEFIMJHD@OnHandShake@
CONST	SEGMENT
??_C@_0M@EEFIMJHD@OnHandShake@ DB 'OnHandShake', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_09JMFCPCNF@HandShake@
CONST	SEGMENT
??_C@_09JMFCPCNF@HandShake@ DB 'HandShake', 00H		; `string'
PUBLIC	?HandShakePhase@CPythonNetworkStream@@IAEXXZ	; CPythonNetworkStream::HandShakePhase
PUBLIC	?__LeaveHandshakePhase@CPythonNetworkStream@@IAEXXZ ; CPythonNetworkStream::__LeaveHandshakePhase
PUBLIC	?RecvHandshakePacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvHandshakePacket
PUBLIC	?RecvHandshakeOKPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvHandshakeOKPacket
PUBLIC	?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvHybridCryptKeyPacket
PUBLIC	?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvHybridCryptSDBPacket
PUBLIC	?RecvKeyAgreementPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvKeyAgreementPacket
PUBLIC	?RecvKeyAgreementCompletedPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvKeyAgreementCompletedPacket
PUBLIC	?RecvHSCheckRequest@CPythonNetworkStream@@IAE_NXZ ; CPythonNetworkStream::RecvHSCheckRequest
PUBLIC	?RecvXTrapVerifyRequest@CPythonNetworkStream@@IAE_NXZ ; CPythonNetworkStream::RecvXTrapVerifyRequest
PUBLIC	?SetHandShakePhase@CPythonNetworkStream@@QAEXXZ	; CPythonNetworkStream::SetHandShakePhase
;	COMDAT xdata$x
xdata$x	SEGMENT
__ehfuncinfo$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
__unwindtable$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ DD 0ffffffffH
	DD	FLAT:__unwindfunclet$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ$0
xdata$x	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__ehfuncinfo$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
__unwindtable$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ DD 0ffffffffH
	DD	FLAT:__unwindfunclet$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ$0
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\EterLib\FuncObject.h
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.44.35207\include\xstring
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\EterLib\FuncObject.h
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?SetHandShakePhase@CPythonNetworkStream@@QAEXXZ
_TEXT	SEGMENT
?SetHandShakePhase@CPythonNetworkStream@@QAEXXZ PROC	; CPythonNetworkStream::SetHandShakePhase, COMDAT
; _this$ = ecx

; 98   : {

  00000	51		 push	 ecx
  00001	56		 push	 esi
  00002	8b f1		 mov	 esi, ecx
  00004	57		 push	 edi

; 99   : 	if ("HandShake"!=m_strPhase)

  00005	68 00 00 00 00	 push	 OFFSET ??_C@_09JMFCPCNF@HandShake@
  0000a	8d be 0c 01 00
	00		 lea	 edi, DWORD PTR [esi+268]
  00010	57		 push	 edi
  00011	e8 00 00 00 00	 call	 ??$?8DU?$char_traits@D@std@@V?$allocator@D@1@@std@@YA_NABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@0@QBD@Z ; std::operator==<char,std::char_traits<char>,std::allocator<char> >
  00016	83 c4 08	 add	 esp, 8
  00019	84 c0		 test	 al, al
  0001b	75 1e		 jne	 SHORT $LN8@SetHandSha
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\EterLib\FuncObject.h

; 41   : 			if (m_pSelfObject)

  0001d	8b 86 68 01 00
	00		 mov	 eax, DWORD PTR [esi+360]
  00023	85 c0		 test	 eax, eax
  00025	74 14		 je	 SHORT $LN8@SetHandSha

; 42   : 				if (m_pFuncObject)

  00027	8b 96 70 01 00
	00		 mov	 edx, DWORD PTR [esi+368]
  0002d	85 d2		 test	 edx, edx
  0002f	74 0a		 je	 SHORT $LN8@SetHandSha

; 43   : 					(m_pSelfObject->*m_pFuncObject)();

  00031	8b 8e 74 01 00
	00		 mov	 ecx, DWORD PTR [esi+372]
  00037	03 c8		 add	 ecx, eax
  00039	ff d2		 call	 edx
$LN8@SetHandSha:
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 102  : 	Tracen("");

  0003b	68 00 00 00 00	 push	 OFFSET ??_C@_00CNPNBAHC@@
  00040	e8 00 00 00 00	 call	 ?Tracen@@YAXPBD@Z	; Tracen
  00045	83 c4 04	 add	 esp, 4

; 103  : 	Tracen("## Network - Hand Shake Phase ##");

  00048	68 00 00 00 00	 push	 OFFSET ??_C@_0CB@IOMBLCGI@?$CD?$CD?5Network?5?9?5Hand?5Shake?5Phase?5?$CD@
  0004d	e8 00 00 00 00	 call	 ?Tracen@@YAXPBD@Z	; Tracen
  00052	83 c4 04	 add	 esp, 4

; 104  : 	Tracen("");

  00055	68 00 00 00 00	 push	 OFFSET ??_C@_00CNPNBAHC@@
  0005a	e8 00 00 00 00	 call	 ?Tracen@@YAXPBD@Z	; Tracen
  0005f	83 c4 04	 add	 esp, 4
; File C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.44.35207\include\xstring

; 1638 :         return assign(_Ptr, _Convert_size<size_type>(_Traits::length(_Ptr)));

  00062	8b cf		 mov	 ecx, edi
  00064	6a 09		 push	 9
  00066	68 00 00 00 00	 push	 OFFSET ??_C@_09JMFCPCNF@HandShake@
  0006b	e8 00 00 00 00	 call	 ?assign@?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAEAAV12@QBDI@Z ; std::basic_string<char,std::char_traits<char>,std::allocator<char> >::assign
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 108  : 	m_dwChangingPhaseTime = ELTimer_GetMSec();

  00070	e8 00 00 00 00	 call	 ?ELTimer_GetMSec@@YAKXZ	; ELTimer_GetMSec
  00075	89 86 90 00 00
	00		 mov	 DWORD PTR [esi+144], eax

; 112  : 	SetGameOnline();

  0007b	8b ce		 mov	 ecx, esi
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\EterLib\FuncObject.h

; 24   : 			m_pSelfObject = pSelfObject;

  0007d	89 b6 50 01 00
	00		 mov	 DWORD PTR [esi+336], esi

; 25   : 			m_pFuncObject = pFuncObject;

  00083	c7 86 58 01 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+344], OFFSET ?HandShakePhase@CPythonNetworkStream@@IAEXXZ ; CPythonNetworkStream::HandShakePhase
  0008d	c7 86 5c 01 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+348], 0

; 24   : 			m_pSelfObject = pSelfObject;

  00097	89 b6 68 01 00
	00		 mov	 DWORD PTR [esi+360], esi

; 25   : 			m_pFuncObject = pFuncObject;

  0009d	c7 86 70 01 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+368], OFFSET ?__LeaveHandshakePhase@CPythonNetworkStream@@IAEXXZ ; CPythonNetworkStream::__LeaveHandshakePhase
  000a7	c7 86 74 01 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+372], 0
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 112  : 	SetGameOnline();

  000b1	e8 00 00 00 00	 call	 ?SetGameOnline@CPythonNetworkStream@@IAEXXZ ; CPythonNetworkStream::SetGameOnline

; 113  : 
; 114  : 	if (__DirectEnterMode_IsSet())

  000b6	e8 00 00 00 00	 call	 ?__DirectEnterMode_IsSet@CPythonNetworkStream@@AAE_NXZ ; CPythonNetworkStream::__DirectEnterMode_IsSet
  000bb	84 c0		 test	 al, al
  000bd	75 22		 jne	 SHORT $LN4@SetHandSha

; 115  : 	{
; 116  : 		// None
; 117  : 	}
; 118  : 	else
; 119  : 	{
; 120  : 		PyCallClassMemberFunc(m_apoPhaseWnd[PHASE_WINDOW_LOGIN], "OnHandShake", Py_BuildValue("()"));

  000bf	68 00 00 00 00	 push	 OFFSET ??_C@_02HCKGKOFO@?$CI?$CJ@
  000c4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__Py_BuildValue
  000ca	83 c4 04	 add	 esp, 4
  000cd	50		 push	 eax
  000ce	68 00 00 00 00	 push	 OFFSET ??_C@_0M@EEFIMJHD@OnHandShake@
  000d3	ff b6 80 01 00
	00		 push	 DWORD PTR [esi+384]
  000d9	e8 00 00 00 00	 call	 ?PyCallClassMemberFunc@@YA_NPAU_object@@PBD0@Z ; PyCallClassMemberFunc
  000de	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN4@SetHandSha:

; 121  : 	}
; 122  : }

  000e1	5f		 pop	 edi
  000e2	5e		 pop	 esi
  000e3	59		 pop	 ecx
  000e4	c3		 ret	 0
?SetHandShakePhase@CPythonNetworkStream@@QAEXXZ ENDP	; CPythonNetworkStream::SetHandShakePhase
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvXTrapVerifyRequest@CPythonNetworkStream@@IAE_NXZ
_TEXT	SEGMENT
_packet$ = -268						; size = 129
_packet_res$ = -136					; size = 129
__$ArrayPad$ = -4					; size = 4
?RecvXTrapVerifyRequest@CPythonNetworkStream@@IAE_NXZ PROC ; CPythonNetworkStream::RecvXTrapVerifyRequest, COMDAT
; _this$ = ecx

; 309  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 01 00
	00		 sub	 esp, 268		; 0000010cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi

; 310  : 	TPacketXTrapCSVerify packet;
; 311  : 
; 312  : 	if (!Recv(sizeof(packet), &packet))

  00014	8d 85 f4 fe ff
	ff		 lea	 eax, DWORD PTR _packet$[ebp]
  0001a	8b f1		 mov	 esi, ecx
  0001c	50		 push	 eax
  0001d	68 81 00 00 00	 push	 129			; 00000081H
  00022	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00027	84 c0		 test	 al, al
  00029	75 1e		 jne	 SHORT $LN2@RecvXTrapV

; 313  : 	{
; 314  : 		TraceError("XTrap: Recv failed");

  0002b	68 00 00 00 00	 push	 OFFSET ??_C@_0BD@DGLFIMMB@XTrap?3?5Recv?5failed@
  00030	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00035	83 c4 04	 add	 esp, 4

; 315  : 
; 316  : 		return false;

  00038	32 c0		 xor	 al, al
  0003a	5e		 pop	 esi

; 328  : 	}
; 329  : 
; 330  : 	return true;
; 331  : }

  0003b	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0003e	33 cd		 xor	 ecx, ebp
  00040	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00045	8b e5		 mov	 esp, ebp
  00047	5d		 pop	 ebp
  00048	c3		 ret	 0
$LN2@RecvXTrapV:

; 317  : 	}
; 318  : 
; 319  : 	TPacketXTrapCSVerify packet_res;
; 320  : 	packet_res.bHeader = HEADER_CG_XTRAP_ACK;
; 321  : 
; 322  : 	XTrap_ValidateCheckStream( packet.bPacketData, packet_res.bPacketData );
; 323  : 
; 324  : 	if (!Send(sizeof(packet_res), &packet_res))

  00049	8d 85 78 ff ff
	ff		 lea	 eax, DWORD PTR _packet_res$[ebp]
  0004f	c6 85 78 ff ff
	ff cc		 mov	 BYTE PTR _packet_res$[ebp], 204 ; 000000ccH
  00056	50		 push	 eax
  00057	68 81 00 00 00	 push	 129			; 00000081H
  0005c	8b ce		 mov	 ecx, esi
  0005e	e8 00 00 00 00	 call	 ?Send@CNetworkStream@@QAE_NHPBX@Z ; CNetworkStream::Send
  00063	84 c0		 test	 al, al
  00065	75 1e		 jne	 SHORT $LN3@RecvXTrapV

; 325  : 	{
; 326  : 		TraceError("XTrap: Send failed");

  00067	68 00 00 00 00	 push	 OFFSET ??_C@_0BD@NKNICBOJ@XTrap?3?5Send?5failed@
  0006c	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00071	83 c4 04	 add	 esp, 4

; 327  : 		return false;

  00074	32 c0		 xor	 al, al
  00076	5e		 pop	 esi

; 328  : 	}
; 329  : 
; 330  : 	return true;
; 331  : }

  00077	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0007a	33 cd		 xor	 ecx, ebp
  0007c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00081	8b e5		 mov	 esp, ebp
  00083	5d		 pop	 ebp
  00084	c3		 ret	 0
$LN3@RecvXTrapV:
  00085	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00088	b0 01		 mov	 al, 1
  0008a	33 cd		 xor	 ecx, ebp
  0008c	5e		 pop	 esi
  0008d	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00092	8b e5		 mov	 esp, ebp
  00094	5d		 pop	 ebp
  00095	c3		 ret	 0
?RecvXTrapVerifyRequest@CPythonNetworkStream@@IAE_NXZ ENDP ; CPythonNetworkStream::RecvXTrapVerifyRequest
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvHSCheckRequest@CPythonNetworkStream@@IAE_NXZ
_TEXT	SEGMENT
_packet$ = -408						; size = 403
__$ArrayPad$ = -4					; size = 4
?RecvHSCheckRequest@CPythonNetworkStream@@IAE_NXZ PROC	; CPythonNetworkStream::RecvHSCheckRequest, COMDAT
; _this$ = ecx

; 269  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 98 01 00
	00		 sub	 esp, 408		; 00000198H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 270  : 	TPacketHSCheck packet;
; 271  : 
; 272  : 	if (!Recv(sizeof(packet), &packet))

  00013	8d 85 68 fe ff
	ff		 lea	 eax, DWORD PTR _packet$[ebp]
  00019	50		 push	 eax
  0001a	68 93 01 00 00	 push	 403			; 00000193H
  0001f	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00024	84 c0		 test	 al, al
  00026	75 0d		 jne	 SHORT $LN2@RecvHSChec

; 273  : 	{
; 274  : 		TraceError("HShield: Recv failed");

  00028	68 00 00 00 00	 push	 OFFSET ??_C@_0BF@EDCCLJMF@HShield?3?5Recv?5failed@
  0002d	e8 00 00 00 00	 call	 ?TraceError@@YAXPBDZZ	; TraceError
  00032	83 c4 04	 add	 esp, 4
$LN2@RecvHSChec:

; 275  : 
; 276  : 		return false;
; 277  : 	}
; 278  : 
; 279  : #if defined(USE_AHNLAB_HACKSHIELD) || defined(LOCALE_SERVICE_GLOBAL)
; 280  : 	TPacketHSCheck pack_ret;
; 281  : 	memset(&pack_ret, 0, sizeof(pack_ret));
; 282  : 	pack_ret.bHeader = HEADER_CG_HS_ACK;
; 283  : 
; 284  : #if defined(USE_AHNLAB_HACKSHIELD)
; 285  : 	unsigned long ret = _AhnHS_MakeResponse( packet.Req.byBuffer, packet.Req.nLength, &pack_ret.Req );
; 286  : 
; 287  : 	if (ERROR_SUCCESS != ret)
; 288  : 	{
; 289  : 		TraceError("HShield: _AhnHS_MakeResponse return error(%u)", ret);
; 290  : 
; 291  : 		return false;
; 292  : 	}
; 293  : #endif
; 294  : 
; 295  : 	if (!Send(sizeof(pack_ret), &pack_ret))
; 296  : 	{
; 297  : 		TraceError("HShield: Send failed");
; 298  : 
; 299  : 		return false;
; 300  : 	}
; 301  : 
; 302  : 	return true;
; 303  : #else
; 304  : 	return false;
; 305  : #endif
; 306  : }

  00035	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00038	32 c0		 xor	 al, al
  0003a	33 cd		 xor	 ecx, ebp
  0003c	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00041	8b e5		 mov	 esp, ebp
  00043	5d		 pop	 ebp
  00044	c3		 ret	 0
?RecvHSCheckRequest@CPythonNetworkStream@@IAE_NXZ ENDP	; CPythonNetworkStream::RecvHSCheckRequest
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvKeyAgreementCompletedPacket@CPythonNetworkStream@@QAE_NXZ
_TEXT	SEGMENT
_packet$ = -4						; size = 4
?RecvKeyAgreementCompletedPacket@CPythonNetworkStream@@QAE_NXZ PROC ; CPythonNetworkStream::RecvKeyAgreementCompletedPacket, COMDAT
; _this$ = ecx

; 253  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	56		 push	 esi

; 254  : 	TPacketKeyAgreementCompleted packet;
; 255  : 	if (!Recv(sizeof(packet), &packet))

  00005	8d 45 fc	 lea	 eax, DWORD PTR _packet$[ebp]
  00008	8b f1		 mov	 esi, ecx
  0000a	50		 push	 eax
  0000b	6a 04		 push	 4
  0000d	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00012	84 c0		 test	 al, al
  00014	75 05		 jne	 SHORT $LN2@RecvKeyAgr
  00016	5e		 pop	 esi

; 265  : }

  00017	8b e5		 mov	 esp, ebp
  00019	5d		 pop	 ebp
  0001a	c3		 ret	 0
$LN2@RecvKeyAgr:

; 256  : 	{
; 257  : 		return false;
; 258  : 	}
; 259  : 
; 260  : 	Tracenf("KEY_AGREEMENT_COMPLETED RECV");

  0001b	68 00 00 00 00	 push	 OFFSET ??_C@_0BN@EDLJMNFO@KEY_AGREEMENT_COMPLETED?5RECV@
  00020	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  00025	83 c4 04	 add	 esp, 4

; 261  : 
; 262  : 	ActivateCipher();

  00028	8b ce		 mov	 ecx, esi
  0002a	e8 00 00 00 00	 call	 ?ActivateCipher@CNetworkStream@@IAEXXZ ; CNetworkStream::ActivateCipher

; 263  : 
; 264  : 	return true;

  0002f	b0 01		 mov	 al, 1
  00031	5e		 pop	 esi

; 265  : }

  00032	8b e5		 mov	 esp, ebp
  00034	5d		 pop	 ebp
  00035	c3		 ret	 0
?RecvKeyAgreementCompletedPacket@CPythonNetworkStream@@QAE_NXZ ENDP ; CPythonNetworkStream::RecvKeyAgreementCompletedPacket
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvKeyAgreementPacket@CPythonNetworkStream@@QAE_NXZ
_TEXT	SEGMENT
_dataLength$ = -536					; size = 4
_packet$ = -532						; size = 261
_packetToSend$ = -268					; size = 261
__$ArrayPad$ = -4					; size = 4
?RecvKeyAgreementPacket@CPythonNetworkStream@@QAE_NXZ PROC ; CPythonNetworkStream::RecvKeyAgreementPacket, COMDAT
; _this$ = ecx

; 209  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 18 02 00
	00		 sub	 esp, 536		; 00000218H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	57		 push	 edi

; 210  : 	TPacketKeyAgreement packet;
; 211  : 	if (!Recv(sizeof(packet), &packet))

  00015	8d 85 ec fd ff
	ff		 lea	 eax, DWORD PTR _packet$[ebp]
  0001b	8b f1		 mov	 esi, ecx
  0001d	50		 push	 eax
  0001e	68 05 01 00 00	 push	 261			; 00000105H
  00023	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00028	84 c0		 test	 al, al
  0002a	0f 84 bd 00 00
	00		 je	 $LN9@RecvKeyAgr

; 212  : 	{
; 213  : 		return false;
; 214  : 	}
; 215  : 
; 216  : 	Tracenf("KEY_AGREEMENT RECV %u", packet.wDataLength);

  00030	0f b7 85 ef fd
	ff ff		 movzx	 eax, WORD PTR _packet$[ebp+3]
  00037	50		 push	 eax
  00038	68 00 00 00 00	 push	 OFFSET ??_C@_0BG@BIKAAIDD@KEY_AGREEMENT?5RECV?5?$CFu@
  0003d	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  00042	83 c4 08	 add	 esp, 8

; 217  : 
; 218  : 	TPacketKeyAgreement packetToSend;
; 219  : 	size_t dataLength = TPacketKeyAgreement::MAX_DATA_LEN;

  00045	c7 85 e8 fd ff
	ff 00 01 00 00	 mov	 DWORD PTR _dataLength$[ebp], 256 ; 00000100H

; 220  : 	size_t agreedLength = Prepare(packetToSend.data, &dataLength);

  0004f	8d 85 e8 fd ff
	ff		 lea	 eax, DWORD PTR _dataLength$[ebp]
  00055	8b ce		 mov	 ecx, esi
  00057	50		 push	 eax
  00058	8d 85 f9 fe ff
	ff		 lea	 eax, DWORD PTR _packetToSend$[ebp+5]
  0005e	50		 push	 eax
  0005f	e8 00 00 00 00	 call	 ?Prepare@CNetworkStream@@IAEIPAXPAI@Z ; CNetworkStream::Prepare
  00064	8b f8		 mov	 edi, eax

; 221  : 	if (agreedLength == 0)

  00066	85 ff		 test	 edi, edi
  00068	74 7c		 je	 SHORT $LN4@RecvKeyAgr

; 222  : 	{
; 223  : 		// 초기화 실패
; 224  : 		Disconnect();
; 225  : 		return false;
; 226  : 	}
; 227  : 	assert(dataLength <= TPacketKeyAgreement::MAX_DATA_LEN);
; 228  : 
; 229  : 	if (Activate(packet.wAgreedLength, packet.data, packet.wDataLength))

  0006a	0f b7 8d ef fd
	ff ff		 movzx	 ecx, WORD PTR _packet$[ebp+3]
  00071	8d 85 f1 fd ff
	ff		 lea	 eax, DWORD PTR _packet$[ebp+5]
  00077	51		 push	 ecx
  00078	0f b7 8d ed fd
	ff ff		 movzx	 ecx, WORD PTR _packet$[ebp+1]
  0007f	50		 push	 eax
  00080	51		 push	 ecx
  00081	8b ce		 mov	 ecx, esi
  00083	e8 00 00 00 00	 call	 ?Activate@CNetworkStream@@IAE_NIPBXI@Z ; CNetworkStream::Activate
  00088	84 c0		 test	 al, al
  0008a	74 5a		 je	 SHORT $LN4@RecvKeyAgr

; 230  : 	{
; 231  : 		// Key agreement 성공, 응답 전송
; 232  : 		packetToSend.bHeader = HEADER_CG_KEY_AGREEMENT;
; 233  : 		packetToSend.wAgreedLength = (WORD)agreedLength;
; 234  : 		packetToSend.wDataLength = (WORD)dataLength;

  0008c	66 8b 85 e8 fd
	ff ff		 mov	 ax, WORD PTR _dataLength$[ebp]

; 235  : 
; 236  : 		if (!Send(sizeof(packetToSend), &packetToSend))

  00093	8b ce		 mov	 ecx, esi
  00095	66 89 85 f7 fe
	ff ff		 mov	 WORD PTR _packetToSend$[ebp+3], ax
  0009c	8d 85 f4 fe ff
	ff		 lea	 eax, DWORD PTR _packetToSend$[ebp]
  000a2	50		 push	 eax
  000a3	68 05 01 00 00	 push	 261			; 00000105H
  000a8	c6 85 f4 fe ff
	ff fb		 mov	 BYTE PTR _packetToSend$[ebp], 251 ; 000000fbH
  000af	66 89 bd f5 fe
	ff ff		 mov	 WORD PTR _packetToSend$[ebp+1], di
  000b6	e8 00 00 00 00	 call	 ?Send@CNetworkStream@@QAE_NHPBX@Z ; CNetworkStream::Send
  000bb	84 c0		 test	 al, al
  000bd	74 2e		 je	 SHORT $LN9@RecvKeyAgr

; 237  : 		{
; 238  : 			assert(!"Failed Sending KeyAgreement");
; 239  : 			return false;
; 240  : 		}
; 241  : 		Tracenf("KEY_AGREEMENT SEND %u", packetToSend.wDataLength);

  000bf	0f b7 85 f7 fe
	ff ff		 movzx	 eax, WORD PTR _packetToSend$[ebp+3]
  000c6	50		 push	 eax
  000c7	68 00 00 00 00	 push	 OFFSET ??_C@_0BG@HCLENPJB@KEY_AGREEMENT?5SEND?5?$CFu@
  000cc	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  000d1	83 c4 08	 add	 esp, 8

; 247  : 		return false;
; 248  : 	}
; 249  : 	return true;

  000d4	b0 01		 mov	 al, 1
  000d6	5f		 pop	 edi

; 250  : }

  000d7	5e		 pop	 esi
  000d8	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000db	33 cd		 xor	 ecx, ebp
  000dd	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000e2	8b e5		 mov	 esp, ebp
  000e4	5d		 pop	 ebp
  000e5	c3		 ret	 0
$LN4@RecvKeyAgr:

; 242  : 	}
; 243  : 	else
; 244  : 	{
; 245  : 		// 키 협상 실패
; 246  : 		Disconnect();

  000e6	8b ce		 mov	 ecx, esi
  000e8	e8 00 00 00 00	 call	 ?Disconnect@CNetworkStream@@QAEXXZ ; CNetworkStream::Disconnect
$LN9@RecvKeyAgr:

; 250  : }

  000ed	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000f0	32 c0		 xor	 al, al
  000f2	5f		 pop	 edi
  000f3	33 cd		 xor	 ecx, ebp
  000f5	5e		 pop	 esi
  000f6	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000fb	8b e5		 mov	 esp, ebp
  000fd	5d		 pop	 ebp
  000fe	c3		 ret	 0
?RecvKeyAgreementPacket@CPythonNetworkStream@@QAE_NXZ ENDP ; CPythonNetworkStream::RecvKeyAgreementPacket
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ
_TEXT	SEGMENT
_kPacket$ = -28						; size = 11
_header$ = -16						; size = 3
__$EHRec$ = -12						; size = 12
?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ PROC ; CPythonNetworkStream::RecvHybridCryptSDBPacket, COMDAT
; _this$ = ecx

; 187  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	83 ec 10	 sub	 esp, 16			; 00000010H
  00014	53		 push	 ebx
  00015	56		 push	 esi
  00016	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0001b	33 c5		 xor	 eax, ebp
  0001d	50		 push	 eax
  0001e	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  00021	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00027	8b f1		 mov	 esi, ecx

; 188  : 	int iFixedHeaderSize = TPacketGCHybridSDB::GetFixedHeaderSize();
; 189  : 
; 190  : 	TDynamicSizePacketHeader header;
; 191  : 	if( !Peek( sizeof(header), &header) )

  00029	8d 45 f0	 lea	 eax, DWORD PTR _header$[ebp]
  0002c	50		 push	 eax
  0002d	6a 03		 push	 3
  0002f	e8 00 00 00 00	 call	 ?Peek@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Peek
  00034	84 c0		 test	 al, al
  00036	75 11		 jne	 SHORT $LN2@RecvHybrid

; 204  : }

  00038	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  0003b	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00042	59		 pop	 ecx
  00043	5e		 pop	 esi
  00044	5b		 pop	 ebx
  00045	8b e5		 mov	 esp, ebp
  00047	5d		 pop	 ebp
  00048	c3		 ret	 0
$LN2@RecvHybrid:

; 192  : 		return false;
; 193  : 
; 194  : 	TPacketGCHybridSDB kPacket(header.size-iFixedHeaderSize);

  00049	0f b7 45 f1	 movzx	 eax, WORD PTR _header$[ebp+1]
  0004d	83 e8 07	 sub	 eax, 7
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h

; 2666 : 		m_pStream = new BYTE[iStreamSize];

  00050	50		 push	 eax
  00051	89 45 e7	 mov	 DWORD PTR _kPacket$[ebp+3], eax
  00054	e8 00 00 00 00	 call	 ??_U@YAPAXI@Z		; operator new[]
  00059	83 c4 04	 add	 esp, 4
  0005c	89 45 eb	 mov	 DWORD PTR _kPacket$[ebp+7], eax
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 196  : 	if (!Recv(iFixedHeaderSize, &kPacket))

  0005f	8d 45 e4	 lea	 eax, DWORD PTR _kPacket$[ebp]
  00062	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$EHRec$[ebp+8], 0
  00069	50		 push	 eax
  0006a	6a 07		 push	 7
  0006c	8b ce		 mov	 ecx, esi
  0006e	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00073	84 c0		 test	 al, al
  00075	74 23		 je	 SHORT $LN7@RecvHybrid

; 197  : 		return false;
; 198  : 
; 199  : 	if (!Recv(kPacket.iSDBStreamLen, kPacket.m_pStream))

  00077	ff 75 eb	 push	 DWORD PTR _kPacket$[ebp+7]
  0007a	8b ce		 mov	 ecx, esi
  0007c	ff 75 e7	 push	 DWORD PTR _kPacket$[ebp+3]
  0007f	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00084	84 c0		 test	 al, al
  00086	74 12		 je	 SHORT $LN7@RecvHybrid

; 200  : 		return false;
; 201  : 
; 202  : 	CEterPackManager::Instance().RetrieveHybridCryptPackSDB( kPacket.m_pStream ); 

  00088	ff 75 eb	 push	 DWORD PTR _kPacket$[ebp+7]
  0008b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A ; CSingleton<CEterPackManager>::ms_singleton
  00091	e8 00 00 00 00	 call	 ?RetrieveHybridCryptPackSDB@CEterPackManager@@QAEXPBE@Z ; CEterPackManager::RetrieveHybridCryptPackSDB

; 203  : 	return true;

  00096	b3 01		 mov	 bl, 1
  00098	eb 02		 jmp	 SHORT $LN8@RecvHybrid
$LN7@RecvHybrid:
  0009a	32 db		 xor	 bl, bl
$LN8@RecvHybrid:
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h

; 2670 : 		delete[] m_pStream;

  0009c	ff 75 eb	 push	 DWORD PTR _kPacket$[ebp+7]
  0009f	e8 00 00 00 00	 call	 ??_V@YAXPAX@Z		; operator delete[]
  000a4	83 c4 04	 add	 esp, 4
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 203  : 	return true;

  000a7	8a c3		 mov	 al, bl

; 204  : }

  000a9	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  000ac	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000b3	59		 pop	 ecx
  000b4	5e		 pop	 esi
  000b5	5b		 pop	 ebx
  000b6	8b e5		 mov	 esp, ebp
  000b8	5d		 pop	 ebp
  000b9	c3		 ret	 0
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ$0:
  00000	8d 4d e4	 lea	 ecx, DWORD PTR _kPacket$[ebp]
  00003	e9 00 00 00 00	 jmp	 ??1SPacketGCHybridSDB@@QAE@XZ ; SPacketGCHybridSDB::~SPacketGCHybridSDB
  00008	cc		 int	 3
  00009	cc		 int	 3
  0000a	cc		 int	 3
  0000b	cc		 int	 3
  0000c	cc		 int	 3
__ehhandler$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ:
  0000d	90		 npad	 1
  0000e	90		 npad	 1
  0000f	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00013	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00016	8b 4a e4	 mov	 ecx, DWORD PTR [edx-28]
  00019	33 c8		 xor	 ecx, eax
  0001b	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00020	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ
  00025	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ ENDP ; CPythonNetworkStream::RecvHybridCryptSDBPacket
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ
_TEXT	SEGMENT
_kPacket$ = -28						; size = 11
_header$ = -16						; size = 3
__$EHRec$ = -12						; size = 12
?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ PROC ; CPythonNetworkStream::RecvHybridCryptKeyPacket, COMDAT
; _this$ = ecx

; 167  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a ff		 push	 -1
  00005	68 00 00 00 00	 push	 __ehhandler$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ
  0000a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00010	50		 push	 eax
  00011	83 ec 10	 sub	 esp, 16			; 00000010H
  00014	53		 push	 ebx
  00015	56		 push	 esi
  00016	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0001b	33 c5		 xor	 eax, ebp
  0001d	50		 push	 eax
  0001e	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  00021	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00027	8b f1		 mov	 esi, ecx

; 168  : 	int iFixedHeaderSize = TPacketGCHybridCryptKeys::GetFixedHeaderSize();
; 169  : 
; 170  : 	TDynamicSizePacketHeader header;
; 171  : 	if( !Peek( sizeof(header), &header) )

  00029	8d 45 f0	 lea	 eax, DWORD PTR _header$[ebp]
  0002c	50		 push	 eax
  0002d	6a 03		 push	 3
  0002f	e8 00 00 00 00	 call	 ?Peek@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Peek
  00034	84 c0		 test	 al, al
  00036	75 11		 jne	 SHORT $LN2@RecvHybrid

; 184  : }

  00038	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  0003b	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00042	59		 pop	 ecx
  00043	5e		 pop	 esi
  00044	5b		 pop	 ebx
  00045	8b e5		 mov	 esp, ebp
  00047	5d		 pop	 ebp
  00048	c3		 ret	 0
$LN2@RecvHybrid:

; 172  : 		return false;
; 173  : 
; 174  : 	TPacketGCHybridCryptKeys kPacket(header.size-iFixedHeaderSize);

  00049	0f b7 45 f1	 movzx	 eax, WORD PTR _header$[ebp+1]
  0004d	83 e8 07	 sub	 eax, 7
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h

; 2635 : 		m_pStream = new BYTE[iStreamSize];

  00050	50		 push	 eax
  00051	89 45 e7	 mov	 DWORD PTR _kPacket$[ebp+3], eax
  00054	e8 00 00 00 00	 call	 ??_U@YAPAXI@Z		; operator new[]
  00059	83 c4 04	 add	 esp, 4
  0005c	89 45 eb	 mov	 DWORD PTR _kPacket$[ebp+7], eax
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 176  : 	if (!Recv(iFixedHeaderSize, &kPacket))

  0005f	8d 45 e4	 lea	 eax, DWORD PTR _kPacket$[ebp]
  00062	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$EHRec$[ebp+8], 0
  00069	50		 push	 eax
  0006a	6a 07		 push	 7
  0006c	8b ce		 mov	 ecx, esi
  0006e	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00073	84 c0		 test	 al, al
  00075	74 23		 je	 SHORT $LN7@RecvHybrid

; 177  : 		return false;
; 178  : 
; 179  : 	if (!Recv(kPacket.iKeyStreamLen, kPacket.m_pStream))

  00077	ff 75 eb	 push	 DWORD PTR _kPacket$[ebp+7]
  0007a	8b ce		 mov	 ecx, esi
  0007c	ff 75 e7	 push	 DWORD PTR _kPacket$[ebp+3]
  0007f	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00084	84 c0		 test	 al, al
  00086	74 12		 je	 SHORT $LN7@RecvHybrid

; 180  : 		return false;
; 181  : 
; 182  : 	CEterPackManager::Instance().RetrieveHybridCryptPackKeys( kPacket.m_pStream ); 

  00088	ff 75 eb	 push	 DWORD PTR _kPacket$[ebp+7]
  0008b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCEterPackManager@@@@0PAVCEterPackManager@@A ; CSingleton<CEterPackManager>::ms_singleton
  00091	e8 00 00 00 00	 call	 ?RetrieveHybridCryptPackKeys@CEterPackManager@@QAEXPBE@Z ; CEterPackManager::RetrieveHybridCryptPackKeys

; 183  : 	return true;

  00096	b3 01		 mov	 bl, 1
  00098	eb 02		 jmp	 SHORT $LN8@RecvHybrid
$LN7@RecvHybrid:
  0009a	32 db		 xor	 bl, bl
$LN8@RecvHybrid:
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\Packet.h

; 2639 : 		if( m_pStream )

  0009c	8b 4d eb	 mov	 ecx, DWORD PTR _kPacket$[ebp+7]
  0009f	85 c9		 test	 ecx, ecx
  000a1	74 09		 je	 SHORT $LN12@RecvHybrid

; 2640 : 		{
; 2641 : 			delete[] m_pStream;

  000a3	51		 push	 ecx
  000a4	e8 00 00 00 00	 call	 ??_V@YAXPAX@Z		; operator delete[]
  000a9	83 c4 04	 add	 esp, 4
$LN12@RecvHybrid:
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp

; 183  : 	return true;

  000ac	8a c3		 mov	 al, bl

; 184  : }

  000ae	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  000b1	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000b8	59		 pop	 ecx
  000b9	5e		 pop	 esi
  000ba	5b		 pop	 ebx
  000bb	8b e5		 mov	 esp, ebp
  000bd	5d		 pop	 ebp
  000be	c3		 ret	 0
_TEXT	ENDS
;	COMDAT text$x
text$x	SEGMENT
__unwindfunclet$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ$0:
  00000	8d 4d e4	 lea	 ecx, DWORD PTR _kPacket$[ebp]
  00003	e9 00 00 00 00	 jmp	 ??1SPacketGCHybridCryptKeys@@QAE@XZ ; SPacketGCHybridCryptKeys::~SPacketGCHybridCryptKeys
  00008	cc		 int	 3
  00009	cc		 int	 3
  0000a	cc		 int	 3
  0000b	cc		 int	 3
  0000c	cc		 int	 3
__ehhandler$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ:
  0000d	90		 npad	 1
  0000e	90		 npad	 1
  0000f	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00013	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00016	8b 4a e4	 mov	 ecx, DWORD PTR [edx-28]
  00019	33 c8		 xor	 ecx, eax
  0001b	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00020	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ
  00025	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ ENDP ; CPythonNetworkStream::RecvHybridCryptKeyPacket
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvHandshakeOKPacket@CPythonNetworkStream@@QAE_NXZ
_TEXT	SEGMENT
_kBlankPacket$ = -1					; size = 1
?RecvHandshakeOKPacket@CPythonNetworkStream@@QAE_NXZ PROC ; CPythonNetworkStream::RecvHandshakeOKPacket, COMDAT
; _this$ = ecx

; 153  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	53		 push	 ebx

; 154  : 	TPacketGCBlank kBlankPacket;
; 155  : 	if (!Recv(sizeof(TPacketGCBlank), &kBlankPacket))

  00005	8d 45 ff	 lea	 eax, DWORD PTR _kBlankPacket$[ebp]
  00008	8b d9		 mov	 ebx, ecx
  0000a	50		 push	 eax
  0000b	6a 01		 push	 1
  0000d	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  00012	84 c0		 test	 al, al
  00014	75 05		 jne	 SHORT $LN2@RecvHandsh
  00016	5b		 pop	 ebx

; 164  : }

  00017	8b e5		 mov	 esp, ebp
  00019	5d		 pop	 ebp
  0001a	c3		 ret	 0
$LN2@RecvHandsh:
  0001b	56		 push	 esi

; 156  : 		return false;
; 157  : 
; 158  : 	DWORD dwDelta=ELTimer_GetMSec()-m_kServerTimeSync.m_dwChangeClientTime;

  0001c	8b b3 bc 00 00
	00		 mov	 esi, DWORD PTR [ebx+188]
  00022	57		 push	 edi
  00023	e8 00 00 00 00	 call	 ?ELTimer_GetMSec@@YAKXZ	; ELTimer_GetMSec

; 159  : 	ELTimer_SetServerMSec(m_kServerTimeSync.m_dwChangeServerTime+dwDelta);

  00028	8b 8b b8 00 00
	00		 mov	 ecx, DWORD PTR [ebx+184]
  0002e	8b f8		 mov	 edi, eax
  00030	2b fe		 sub	 edi, esi
  00032	03 cf		 add	 ecx, edi
  00034	51		 push	 ecx
  00035	e8 00 00 00 00	 call	 ?ELTimer_SetServerMSec@@YAXK@Z ; ELTimer_SetServerMSec

; 160  : 
; 161  : 	Tracenf("HANDSHAKE OK RECV %u %u", m_kServerTimeSync.m_dwChangeServerTime, dwDelta);

  0003a	57		 push	 edi
  0003b	ff b3 b8 00 00
	00		 push	 DWORD PTR [ebx+184]
  00041	68 00 00 00 00	 push	 OFFSET ??_C@_0BI@JCCALMCB@HANDSHAKE?5OK?5RECV?5?$CFu?5?$CFu@
  00046	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  0004b	83 c4 10	 add	 esp, 16			; 00000010H

; 162  : 
; 163  : 	return true;

  0004e	b0 01		 mov	 al, 1
  00050	5f		 pop	 edi
  00051	5e		 pop	 esi
  00052	5b		 pop	 ebx

; 164  : }

  00053	8b e5		 mov	 esp, ebp
  00055	5d		 pop	 ebp
  00056	c3		 ret	 0
?RecvHandshakeOKPacket@CPythonNetworkStream@@QAE_NXZ ENDP ; CPythonNetworkStream::RecvHandshakeOKPacket
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?RecvHandshakePacket@CPythonNetworkStream@@QAE_NXZ
_TEXT	SEGMENT
_kHandshakeData$ = -20					; size = 13
__$ArrayPad$ = -4					; size = 4
?RecvHandshakePacket@CPythonNetworkStream@@QAE_NXZ PROC	; CPythonNetworkStream::RecvHandshakePacket, COMDAT
; _this$ = ecx

; 125  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	56		 push	 esi

; 126  : 	TPacketGCHandshake kHandshakeData;
; 127  : 	if (!Recv(sizeof(TPacketGCHandshake), &kHandshakeData))

  00011	8d 45 ec	 lea	 eax, DWORD PTR _kHandshakeData$[ebp]
  00014	8b f1		 mov	 esi, ecx
  00016	50		 push	 eax
  00017	6a 0d		 push	 13			; 0000000dH
  00019	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  0001e	84 c0		 test	 al, al
  00020	74 75		 je	 SHORT $LN5@RecvHandsh

; 128  : 		return false;
; 129  : 
; 130  : 	Tracenf("HANDSHAKE RECV %u %d", kHandshakeData.dwTime, kHandshakeData.lDelta);

  00022	ff 75 f5	 push	 DWORD PTR _kHandshakeData$[ebp+9]
  00025	ff 75 f1	 push	 DWORD PTR _kHandshakeData$[ebp+5]
  00028	68 00 00 00 00	 push	 OFFSET ??_C@_0BF@MMAJMJLI@HANDSHAKE?5RECV?5?$CFu?5?$CFd@
  0002d	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf

; 131  : 
; 132  : 	m_kServerTimeSync.m_dwChangeServerTime = kHandshakeData.dwTime + kHandshakeData.lDelta;

  00032	8b 45 f1	 mov	 eax, DWORD PTR _kHandshakeData$[ebp+5]
  00035	03 45 f5	 add	 eax, DWORD PTR _kHandshakeData$[ebp+9]
  00038	89 86 b8 00 00
	00		 mov	 DWORD PTR [esi+184], eax

; 133  : 	m_kServerTimeSync.m_dwChangeClientTime = ELTimer_GetMSec();

  0003e	e8 00 00 00 00	 call	 ?ELTimer_GetMSec@@YAKXZ	; ELTimer_GetMSec

; 134  : 	
; 135  : 	kHandshakeData.dwTime = kHandshakeData.dwTime + kHandshakeData.lDelta + kHandshakeData.lDelta;

  00043	8b 4d f5	 mov	 ecx, DWORD PTR _kHandshakeData$[ebp+9]
  00046	89 86 bc 00 00
	00		 mov	 DWORD PTR [esi+188], eax
  0004c	8b 45 f1	 mov	 eax, DWORD PTR _kHandshakeData$[ebp+5]

; 136  : 	kHandshakeData.lDelta = 0;

  0004f	c7 45 f5 00 00
	00 00		 mov	 DWORD PTR _kHandshakeData$[ebp+9], 0
  00056	8d 04 48	 lea	 eax, DWORD PTR [eax+ecx*2]

; 137  : 
; 138  : 	Tracenf("HANDSHAKE SEND %u", kHandshakeData.dwTime);

  00059	50		 push	 eax
  0005a	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@CAMNEEDN@HANDSHAKE?5SEND?5?$CFu@
  0005f	89 45 f1	 mov	 DWORD PTR _kHandshakeData$[ebp+5], eax
  00062	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  00067	83 c4 14	 add	 esp, 20			; 00000014H

; 139  : 
; 140  : 	kHandshakeData.header = HEADER_CG_TIME_SYNC;

  0006a	c6 45 ec fc	 mov	 BYTE PTR _kHandshakeData$[ebp], 252 ; 000000fcH

; 141  : 	if (!Send(sizeof(TPacketGCHandshake), &kHandshakeData))

  0006e	8d 45 ec	 lea	 eax, DWORD PTR _kHandshakeData$[ebp]
  00071	8b ce		 mov	 ecx, esi
  00073	50		 push	 eax
  00074	6a 0d		 push	 13			; 0000000dH
  00076	e8 00 00 00 00	 call	 ?Send@CNetworkStream@@QAE_NHPBX@Z ; CNetworkStream::Send
  0007b	84 c0		 test	 al, al
  0007d	74 18		 je	 SHORT $LN5@RecvHandsh

; 142  : 	{
; 143  : 		assert(!"Failed Sending Handshake");
; 144  : 		return false;
; 145  : 	}
; 146  : 
; 147  : 	SendSequence();

  0007f	8b ce		 mov	 ecx, esi
  00081	e8 00 00 00 00	 call	 ?SendSequence@CNetworkStream@@QAE_NXZ ; CNetworkStream::SendSequence

; 148  : 
; 149  : 	return true;

  00086	b0 01		 mov	 al, 1
  00088	5e		 pop	 esi

; 150  : }

  00089	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0008c	33 cd		 xor	 ecx, ebp
  0008e	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00093	8b e5		 mov	 esp, ebp
  00095	5d		 pop	 ebp
  00096	c3		 ret	 0
$LN5@RecvHandsh:
  00097	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0009a	32 c0		 xor	 al, al
  0009c	33 cd		 xor	 ecx, ebp
  0009e	5e		 pop	 esi
  0009f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000a4	8b e5		 mov	 esp, ebp
  000a6	5d		 pop	 ebp
  000a7	c3		 ret	 0
?RecvHandshakePacket@CPythonNetworkStream@@QAE_NXZ ENDP	; CPythonNetworkStream::RecvHandshakePacket
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStream.h
;	COMDAT ?__LeaveHandshakePhase@CPythonNetworkStream@@IAEXXZ
_TEXT	SEGMENT
?__LeaveHandshakePhase@CPythonNetworkStream@@IAEXXZ PROC ; CPythonNetworkStream::__LeaveHandshakePhase, COMDAT
; _this$ = ecx

; 595  : 		void __LeaveHandshakePhase() {}

  00000	c2 00 00	 ret	 0
?__LeaveHandshakePhase@CPythonNetworkStream@@IAEXXZ ENDP ; CPythonNetworkStream::__LeaveHandshakePhase
_TEXT	ENDS
; Function compile flags: /Ogtp
; File D:\_m2work\txoko-m2-work\txoko-client-src\source\UserInterface\PythonNetworkStreamPhaseHandShake.cpp
;	COMDAT ?HandShakePhase@CPythonNetworkStream@@IAEXXZ
_TEXT	SEGMENT
_BindUDP$1 = -12					; size = 7
_header$ = -1						; size = 1
tv80 = -1						; size = 1
?HandShakePhase@CPythonNetworkStream@@IAEXXZ PROC	; CPythonNetworkStream::HandShakePhase, COMDAT
; _this$ = ecx

; 15   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 10	 sub	 esp, 16			; 00000010H

; 16   : 	TPacketHeader header;
; 17   : 
; 18   : 	if (!CheckPacket(&header))

  00006	8d 45 ff	 lea	 eax, DWORD PTR _header$[ebp]
  00009	56		 push	 esi
  0000a	57		 push	 edi
  0000b	50		 push	 eax
  0000c	8b f1		 mov	 esi, ecx
  0000e	e8 00 00 00 00	 call	 ?CheckPacket@CPythonNetworkStream@@IAE_NPAE@Z ; CPythonNetworkStream::CheckPacket
  00013	84 c0		 test	 al, al
  00015	74 2f		 je	 SHORT $LN1@HandShakeP

; 19   : 		return;
; 20   : 
; 21   : 	switch (header)

  00017	0f b6 7d ff	 movzx	 edi, BYTE PTR _header$[ebp]
  0001b	8d 47 d4	 lea	 eax, DWORD PTR [edi-44]
  0001e	3d d3 00 00 00	 cmp	 eax, 211		; 000000d3H
  00023	77 19		 ja	 SHORT $LN2@HandShakeP
  00025	0f b6 80 00 00
	00 00		 movzx	 eax, BYTE PTR $LN18@HandShakeP[eax]
  0002c	ff 24 85 00 00
	00 00		 jmp	 DWORD PTR $LN19@HandShakeP[eax*4]
$LN5@HandShakeP:

; 22   : 	{
; 23   : 		case HEADER_GC_PHASE:
; 24   : 			if (RecvPhasePacket())

  00033	8b ce		 mov	 ecx, esi
  00035	e8 00 00 00 00	 call	 ?RecvPhasePacket@CPythonNetworkStream@@IAE_NXZ ; CPythonNetworkStream::RecvPhasePacket
  0003a	84 c0		 test	 al, al
  0003c	75 08		 jne	 SHORT $LN1@HandShakeP
$LN2@HandShakeP:

; 89   : 			return;
; 90   : 			break;
; 91   : #endif
; 92   : 	}
; 93   : 
; 94   : 	RecvErrorPacket(header);

  0003e	57		 push	 edi
  0003f	8b ce		 mov	 ecx, esi
  00041	e8 00 00 00 00	 call	 ?RecvErrorPacket@CPythonNetworkStream@@IAE_NH@Z ; CPythonNetworkStream::RecvErrorPacket
$LN1@HandShakeP:

; 95   : }

  00046	5f		 pop	 edi
  00047	5e		 pop	 esi
  00048	8b e5		 mov	 esp, ebp
  0004a	5d		 pop	 ebp
  0004b	c3		 ret	 0
$LN7@HandShakeP:

; 25   : 				return;
; 26   : 			break;
; 27   : 
; 28   : 		case HEADER_GC_BINDUDP:
; 29   : 			{
; 30   : 				TPacketGCBindUDP BindUDP;
; 31   : 				
; 32   : 				if (!Recv(sizeof(TPacketGCBindUDP), &BindUDP))

  0004c	8d 45 f4	 lea	 eax, DWORD PTR _BindUDP$1[ebp]
  0004f	8b ce		 mov	 ecx, esi
  00051	50		 push	 eax
  00052	6a 07		 push	 7
  00054	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv

; 95   : }

  00059	5f		 pop	 edi
  0005a	5e		 pop	 esi
  0005b	8b e5		 mov	 esp, ebp
  0005d	5d		 pop	 ebp
  0005e	c3		 ret	 0
$LN9@HandShakeP:

; 33   : 					return;
; 34   : 
; 35   : 				return;
; 36   : 			}
; 37   : 			break;
; 38   : 
; 39   : 		case HEADER_GC_HANDSHAKE:
; 40   : 			{
; 41   : 				if (!Recv(sizeof(TPacketGCHandshake), &m_HandshakeData))

  0005f	8d be 80 00 00
	00		 lea	 edi, DWORD PTR [esi+128]
  00065	8b ce		 mov	 ecx, esi
  00067	57		 push	 edi
  00068	6a 0d		 push	 13			; 0000000dH
  0006a	e8 00 00 00 00	 call	 ?Recv@CNetworkStream@@QAE_NHPAX@Z ; CNetworkStream::Recv
  0006f	84 c0		 test	 al, al
  00071	74 d3		 je	 SHORT $LN1@HandShakeP

; 42   : 					return;
; 43   : 
; 44   : 				Tracenf("HANDSHAKE RECV %u %d", m_HandshakeData.dwTime, m_HandshakeData.lDelta);

  00073	ff b6 89 00 00
	00		 push	 DWORD PTR [esi+137]
  00079	ff b6 85 00 00
	00		 push	 DWORD PTR [esi+133]
  0007f	68 00 00 00 00	 push	 OFFSET ??_C@_0BF@MMAJMJLI@HANDSHAKE?5RECV?5?$CFu?5?$CFd@
  00084	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf

; 45   : 
; 46   : 				ELTimer_SetServerMSec(m_HandshakeData.dwTime+ m_HandshakeData.lDelta);

  00089	8b 86 85 00 00
	00		 mov	 eax, DWORD PTR [esi+133]
  0008f	83 c4 0c	 add	 esp, 12			; 0000000cH
  00092	03 86 89 00 00
	00		 add	 eax, DWORD PTR [esi+137]
  00098	50		 push	 eax
  00099	e8 00 00 00 00	 call	 ?ELTimer_SetServerMSec@@YAXK@Z ; ELTimer_SetServerMSec

; 47   : 
; 48   : 				//m_dwBaseServerTime = m_HandshakeData.dwTime+ m_HandshakeData.lDelta;
; 49   : 				//m_dwBaseClientTime = ELTimer_GetMSec();
; 50   : 
; 51   : 				m_HandshakeData.dwTime = m_HandshakeData.dwTime + m_HandshakeData.lDelta + m_HandshakeData.lDelta;

  0009e	8b 86 89 00 00
	00		 mov	 eax, DWORD PTR [esi+137]
  000a4	83 c4 04	 add	 esp, 4
  000a7	03 c0		 add	 eax, eax

; 52   : 				m_HandshakeData.lDelta = 0;

  000a9	c7 86 89 00 00
	00 00 00 00 00	 mov	 DWORD PTR [esi+137], 0
  000b3	01 86 85 00 00
	00		 add	 DWORD PTR [esi+133], eax

; 53   : 
; 54   : 				Tracenf("HANDSHAKE SEND %u", m_HandshakeData.dwTime);

  000b9	ff b6 85 00 00
	00		 push	 DWORD PTR [esi+133]
  000bf	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@CAMNEEDN@HANDSHAKE?5SEND?5?$CFu@
  000c4	e8 00 00 00 00	 call	 ?Tracenf@@YAXPBDZZ	; Tracenf
  000c9	83 c4 08	 add	 esp, 8

; 55   : 
; 56   : 				if (!Send(sizeof(TPacketGCHandshake), &m_HandshakeData))

  000cc	8b ce		 mov	 ecx, esi
  000ce	57		 push	 edi
  000cf	6a 0d		 push	 13			; 0000000dH
  000d1	e8 00 00 00 00	 call	 ?Send@CNetworkStream@@QAE_NHPBX@Z ; CNetworkStream::Send
  000d6	84 c0		 test	 al, al
  000d8	0f 84 68 ff ff
	ff		 je	 $LN1@HandShakeP

; 57   : 				{
; 58   : 					assert(!"Failed Sending Handshake");
; 59   : 					return;
; 60   : 				}
; 61   : 
; 62   : 				CTimer::Instance().SetBaseTime();

  000de	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$CSingleton@VCTimer@@@@0PAVCTimer@@A ; CSingleton<CTimer>::ms_singleton
  000e4	e8 00 00 00 00	 call	 ?SetBaseTime@CTimer@@QAEXXZ ; CTimer::SetBaseTime

; 95   : }

  000e9	5f		 pop	 edi
  000ea	5e		 pop	 esi
  000eb	8b e5		 mov	 esp, ebp
  000ed	5d		 pop	 ebp
  000ee	c3		 ret	 0
$LN12@HandShakeP:

; 63   : 				return;
; 64   : 			}
; 65   : 			break;
; 66   : 		case HEADER_GC_PING:
; 67   : 			RecvPingPacket();

  000ef	8b ce		 mov	 ecx, esi
  000f1	e8 00 00 00 00	 call	 ?RecvPingPacket@CPythonNetworkStream@@IAE_NXZ ; CPythonNetworkStream::RecvPingPacket

; 95   : }

  000f6	5f		 pop	 edi
  000f7	5e		 pop	 esi
  000f8	8b e5		 mov	 esp, ebp
  000fa	5d		 pop	 ebp
  000fb	c3		 ret	 0
$LN13@HandShakeP:

; 68   : 			return;
; 69   : 			break;
; 70   : 
; 71   : 		case HEADER_GC_HYBRIDCRYPT_KEYS:
; 72   : 			RecvHybridCryptKeyPacket();

  000fc	8b ce		 mov	 ecx, esi
  000fe	e8 00 00 00 00	 call	 ?RecvHybridCryptKeyPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvHybridCryptKeyPacket

; 95   : }

  00103	5f		 pop	 edi
  00104	5e		 pop	 esi
  00105	8b e5		 mov	 esp, ebp
  00107	5d		 pop	 ebp
  00108	c3		 ret	 0
$LN14@HandShakeP:

; 73   : 			return;
; 74   : 			break;
; 75   : 
; 76   : 		case HEADER_GC_HYBRIDCRYPT_SDB:
; 77   : 			RecvHybridCryptSDBPacket();

  00109	8b ce		 mov	 ecx, esi
  0010b	e8 00 00 00 00	 call	 ?RecvHybridCryptSDBPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvHybridCryptSDBPacket

; 95   : }

  00110	5f		 pop	 edi
  00111	5e		 pop	 esi
  00112	8b e5		 mov	 esp, ebp
  00114	5d		 pop	 ebp
  00115	c3		 ret	 0
$LN15@HandShakeP:

; 78   : 			return;
; 79   : 			break;
; 80   : 
; 81   : #ifdef _IMPROVED_PACKET_ENCRYPTION_
; 82   : 		case HEADER_GC_KEY_AGREEMENT:
; 83   : 			RecvKeyAgreementPacket();

  00116	8b ce		 mov	 ecx, esi
  00118	e8 00 00 00 00	 call	 ?RecvKeyAgreementPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvKeyAgreementPacket

; 95   : }

  0011d	5f		 pop	 edi
  0011e	5e		 pop	 esi
  0011f	8b e5		 mov	 esp, ebp
  00121	5d		 pop	 ebp
  00122	c3		 ret	 0
$LN16@HandShakeP:

; 84   : 			return;
; 85   : 			break;
; 86   : 
; 87   : 		case HEADER_GC_KEY_AGREEMENT_COMPLETED:
; 88   : 			RecvKeyAgreementCompletedPacket();

  00123	8b ce		 mov	 ecx, esi
  00125	e8 00 00 00 00	 call	 ?RecvKeyAgreementCompletedPacket@CPythonNetworkStream@@QAE_NXZ ; CPythonNetworkStream::RecvKeyAgreementCompletedPacket

; 95   : }

  0012a	5f		 pop	 edi
  0012b	5e		 pop	 esi
  0012c	8b e5		 mov	 esp, ebp
  0012e	5d		 pop	 ebp
  0012f	c3		 ret	 0
$LN19@HandShakeP:
  00130	00 00 00 00	 DD	 $LN12@HandShakeP
  00134	00 00 00 00	 DD	 $LN13@HandShakeP
  00138	00 00 00 00	 DD	 $LN14@HandShakeP
  0013c	00 00 00 00	 DD	 $LN16@HandShakeP
  00140	00 00 00 00	 DD	 $LN15@HandShakeP
  00144	00 00 00 00	 DD	 $LN5@HandShakeP
  00148	00 00 00 00	 DD	 $LN7@HandShakeP
  0014c	00 00 00 00	 DD	 $LN9@HandShakeP
  00150	00 00 00 00	 DD	 $LN2@HandShakeP
$LN18@HandShakeP:
  00154	00		 DB	 0
  00155	08		 DB	 8
  00156	08		 DB	 8
  00157	08		 DB	 8
  00158	08		 DB	 8
  00159	08		 DB	 8
  0015a	08		 DB	 8
  0015b	08		 DB	 8
  0015c	08		 DB	 8
  0015d	08		 DB	 8
  0015e	08		 DB	 8
  0015f	08		 DB	 8
  00160	08		 DB	 8
  00161	08		 DB	 8
  00162	08		 DB	 8
  00163	08		 DB	 8
  00164	08		 DB	 8
  00165	08		 DB	 8
  00166	08		 DB	 8
  00167	08		 DB	 8
  00168	08		 DB	 8
  00169	08		 DB	 8
  0016a	08		 DB	 8
  0016b	08		 DB	 8
  0016c	08		 DB	 8
  0016d	08		 DB	 8
  0016e	08		 DB	 8
  0016f	08		 DB	 8
  00170	08		 DB	 8
  00171	08		 DB	 8
  00172	08		 DB	 8
  00173	08		 DB	 8
  00174	08		 DB	 8
  00175	08		 DB	 8
  00176	08		 DB	 8
  00177	08		 DB	 8
  00178	08		 DB	 8
  00179	08		 DB	 8
  0017a	08		 DB	 8
  0017b	08		 DB	 8
  0017c	08		 DB	 8
  0017d	08		 DB	 8
  0017e	08		 DB	 8
  0017f	08		 DB	 8
  00180	08		 DB	 8
  00181	08		 DB	 8
  00182	08		 DB	 8
  00183	08		 DB	 8
  00184	08		 DB	 8
  00185	08		 DB	 8
  00186	08		 DB	 8
  00187	08		 DB	 8
  00188	08		 DB	 8
  00189	08		 DB	 8
  0018a	08		 DB	 8
  0018b	08		 DB	 8
  0018c	08		 DB	 8
  0018d	08		 DB	 8
  0018e	08		 DB	 8
  0018f	08		 DB	 8
  00190	08		 DB	 8
  00191	08		 DB	 8
  00192	08		 DB	 8
  00193	08		 DB	 8
  00194	08		 DB	 8
  00195	08		 DB	 8
  00196	08		 DB	 8
  00197	08		 DB	 8
  00198	08		 DB	 8
  00199	08		 DB	 8
  0019a	08		 DB	 8
  0019b	08		 DB	 8
  0019c	08		 DB	 8
  0019d	08		 DB	 8
  0019e	08		 DB	 8
  0019f	08		 DB	 8
  001a0	08		 DB	 8
  001a1	08		 DB	 8
  001a2	08		 DB	 8
  001a3	08		 DB	 8
  001a4	08		 DB	 8
  001a5	08		 DB	 8
  001a6	08		 DB	 8
  001a7	08		 DB	 8
  001a8	08		 DB	 8
  001a9	08		 DB	 8
  001aa	08		 DB	 8
  001ab	08		 DB	 8
  001ac	08		 DB	 8
  001ad	08		 DB	 8
  001ae	08		 DB	 8
  001af	08		 DB	 8
  001b0	08		 DB	 8
  001b1	08		 DB	 8
  001b2	08		 DB	 8
  001b3	08		 DB	 8
  001b4	08		 DB	 8
  001b5	08		 DB	 8
  001b6	08		 DB	 8
  001b7	08		 DB	 8
  001b8	08		 DB	 8
  001b9	08		 DB	 8
  001ba	08		 DB	 8
  001bb	08		 DB	 8
  001bc	08		 DB	 8
  001bd	08		 DB	 8
  001be	08		 DB	 8
  001bf	08		 DB	 8
  001c0	01		 DB	 1
  001c1	02		 DB	 2
  001c2	08		 DB	 8
  001c3	08		 DB	 8
  001c4	08		 DB	 8
  001c5	08		 DB	 8
  001c6	08		 DB	 8
  001c7	08		 DB	 8
  001c8	08		 DB	 8
  001c9	08		 DB	 8
  001ca	08		 DB	 8
  001cb	08		 DB	 8
  001cc	08		 DB	 8
  001cd	08		 DB	 8
  001ce	08		 DB	 8
  001cf	08		 DB	 8
  001d0	08		 DB	 8
  001d1	08		 DB	 8
  001d2	08		 DB	 8
  001d3	08		 DB	 8
  001d4	08		 DB	 8
  001d5	08		 DB	 8
  001d6	08		 DB	 8
  001d7	08		 DB	 8
  001d8	08		 DB	 8
  001d9	08		 DB	 8
  001da	08		 DB	 8
  001db	08		 DB	 8
  001dc	08		 DB	 8
  001dd	08		 DB	 8
  001de	08		 DB	 8
  001df	08		 DB	 8
  001e0	08		 DB	 8
  001e1	08		 DB	 8
  001e2	08		 DB	 8
  001e3	08		 DB	 8
  001e4	08		 DB	 8
  001e5	08		 DB	 8
  001e6	08		 DB	 8
  001e7	08		 DB	 8
  001e8	08		 DB	 8
  001e9	08		 DB	 8
  001ea	08		 DB	 8
  001eb	08		 DB	 8
  001ec	08		 DB	 8
  001ed	08		 DB	 8
  001ee	08		 DB	 8
  001ef	08		 DB	 8
  001f0	08		 DB	 8
  001f1	08		 DB	 8
  001f2	08		 DB	 8
  001f3	08		 DB	 8
  001f4	08		 DB	 8
  001f5	08		 DB	 8
  001f6	08		 DB	 8
  001f7	08		 DB	 8
  001f8	08		 DB	 8
  001f9	08		 DB	 8
  001fa	08		 DB	 8
  001fb	08		 DB	 8
  001fc	08		 DB	 8
  001fd	08		 DB	 8
  001fe	08		 DB	 8
  001ff	08		 DB	 8
  00200	08		 DB	 8
  00201	08		 DB	 8
  00202	08		 DB	 8
  00203	08		 DB	 8
  00204	08		 DB	 8
  00205	08		 DB	 8
  00206	08		 DB	 8
  00207	08		 DB	 8
  00208	08		 DB	 8
  00209	08		 DB	 8
  0020a	08		 DB	 8
  0020b	08		 DB	 8
  0020c	08		 DB	 8
  0020d	08		 DB	 8
  0020e	08		 DB	 8
  0020f	08		 DB	 8
  00210	08		 DB	 8
  00211	08		 DB	 8
  00212	08		 DB	 8
  00213	08		 DB	 8
  00214	08		 DB	 8
  00215	08		 DB	 8
  00216	08		 DB	 8
  00217	08		 DB	 8
  00218	08		 DB	 8
  00219	08		 DB	 8
  0021a	08		 DB	 8
  0021b	08		 DB	 8
  0021c	08		 DB	 8
  0021d	08		 DB	 8
  0021e	08		 DB	 8
  0021f	08		 DB	 8
  00220	08		 DB	 8
  00221	08		 DB	 8
  00222	03		 DB	 3
  00223	04		 DB	 4
  00224	08		 DB	 8
  00225	05		 DB	 5
  00226	06		 DB	 6
  00227	07		 DB	 7
?HandShakePhase@CPythonNetworkStream@@IAEXXZ ENDP	; CPythonNetworkStream::HandShakePhase
_TEXT	ENDS
END
